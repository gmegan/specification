The \acp{PE} in an \openshmem program communicate using
\ac{RMA} and \ac{AMO} routines that specify the \ac{PE} number of the target
\ac{PE} or collective routines that operate over some predefined
set of \acp{PE}. Teams in \openshmem allow programs to group subsets
of \acp{PE} for communications. Collective communications operate on
teams objects across the \acp{PE} in the team. \ac{RMA} and \ac{AMO} routines
can make use of team based renumbering of \acp{PE} by utilizing team
based contexts or \ac{PE} number translation.

An \openshmem team is a set of \acp{PE} defined by calling a specific team
split routine with a parent team argument and other arguments to
specify how the parent team is to be split into one or more new teams.
Any team created by a \FUNC{shmem\_team\_split\_*} routine can subsequently
be used as the parent team for further calls to team split routines.
A team persists and can be used for team-based routine calls
until it is destroyed by \FUNC{shmem\_team\_destroy}.

Every team must have a least one member. Any attempt to create a team over an
empty set of \acp{PE} will result in no new team being created.

\subsubsection*{Team Handles and Predefined Teams}

A ``team handle'' is an opaque object with type \CTYPE{shmem\_team\_t} that is used
to reference a defined team.  Team handles are created by one of the team split
routines and destroyed by the team destroy routine. Team handles have local
semantics only. That is, team handles should not be stored in shared variables
and used across other \acp{PE}. Doing so will result in undefined behavior.

A team handle may be initialized to or assigned the value \LibConstRef{SHMEM\_TEAM\_NULL}
to indicate that handle does not reference a valid team. When managed in this way,
applications can use an equality comparison to test whether a given team handle
references a valid team.

By default, \openshmem creates predefined teams that will be available
for use once the routine \FUNC{shmem\_init} has been called. See
Section~\ref{subsec:library_handles} for a description of all predefined team handles
provided by \openshmem. Predefined \CTYPE{shmem\_team\_t} handles can be used as
the parent team when creating new \openshmem teams.

Every \ac{PE} is a member of the default team, which may be referenced
through the team handle \LibHandleRef{SHMEM\_TEAM\_WORLD}.
The \ac{PE} number in the default team is equal to the
value of its \ac{PE} number as returned by \FUNC{shmem\_my\_pe}.

\subsubsection*{Team Objects and Multithreading Within a \ac{PE}}

Team handles are passed as arguments to a variety of \openshmem routines,
including collective routines (see Section~\ref{subsec:coll}), include team
creation routines.  Regardless of the \openshmem threading model
(see section \ref{subsec:thread_support}), it is the responsibility
of the application to ensure that there are no simultaneous collective
routines operating on the same \openshmem team on a given \ac{PE}.

\subsubsection*{Team Objects and Collective Ordering across \acp{PE}}

In \openshmem, a team object encapsulates resources uses to communicate
between \acp{PE} in collective operations. When calling multiple subsequent
collective operations on a team, the collective operations -- along with any
relevant team based resources -- are matched across the \acp{PE} in the team
based on ordering of collective routine calls. It is the responsibility
of the application to ensure a consistent ordering of collective routine calls
across all \acp{PE} in a team.

There is no need for explicit synchronization between subsequent calls
to collective routines across the team, except in the special case discussed
below for team creation of overlapping child teams from a common parent team.

A full discussion of collective semantics follows in Section~\ref{subsec:coll}.

\subsubsection*{Team Creation}

New teams result from a \FUNC{shmem\_team\_split\_*} routine, which takes a parent team
and other arguments and produces new teams that are a subset of the parent
team. Teams are created by a \FUNC{shmem\_team\_split\_*} routine that defines a
collective operation over the set of all \acp{PE} which will be in the newly created
teams. For each new team created by the split operation, a configuration argument
may be provided to specify attributes of the new team.
This configuration argument is of type \CTYPE{shmem\_team\_config\_t}, which
is detailed further in Section~\ref{subsec:shmem_team_config_t}.

Upon completion of a team creation operation, any resulting child teams will be
immediately usable for any team-based operations, including creating new child teams,
without any intervening synchronization.

In multithreaded environments, the program must ensure that there
are no simultaneous split operations occurring on the same parent team on a
given \ac{PE}.

As with any collective routine on a team, team creation is matched across \acp{PE} based
on ordering. So, team creation events must occur in the same order on all \acp{PE}
in the new teams.

The creation of new teams may use global symmetric resources associated with
the parent team. For this reason, the application must guarantee that for
a given \ac{PE} in a given parent team, there cannot be multiple simultaneous
split operations involving that \ac{PE} and that parent team on any set of \acp{PE}
in the \openshmem application.
This guarantee can always be met by following the rule that when a parent team
is split multiple times, and the resulting child teams have overlapping membership,
the program calls the \FUNC{shmem\_team\_sync} routine on the parent team
between subsequent calls to those split routines.
